#INFO: **** input file is /project/lgagliardi/shreyav/moldmet/feh2o6/basis/casdmet/hs/cas1/doscf/imp1/inp.py ****
import sys
from pyscf import gto, scf, symm
from pyscf import mcscf
import numpy as np
import localintegrals, dmet, qcdmet_paths
from pyscf.tools import molden, cubegen
from functools import reduce
#############
#   Input   #
#############              
localization = 'meta_lowdin'                # 'iao' or 'meta_lowdin' or 'boys'

#np.set_printoptions(threshold=sys.maxsize)

one_bath_orb_per_bond = False        # Sun & Chan, JCTC 10, 3784 (2014) [ http://dx.doi.org/10.1021/ct500512f ]
casci_energy_formula = True         # CASCI or DMET energy formula
DMguess = None
mol = gto.Mole()
mol.atom = "/project/lgagliardi/shreyav/moldmet/feh2o6/feh2o62plus-hs.xyz"
mol.basis = {'O':'cc-pvdz', 'Fe':'cc-pvtz', 'H':'cc-pvdz'}
mol.charge = 2
mol.build(verbose=4)
mf = mol.RHF().run()
mf.verbose = 4
mf.max_cycle = 1000
mf.scf(DMguess)
DMguess = mf.make_rdm1()
basis = '6-31g'

if ( True ):
    myInts = localintegrals.localintegrals( mf, range( mol.nao_nr() ), localization )
    unit_sizes = None
    frag = 68
    unit_sizes = np.array([frag,mol.nao_nr()-frag]) # HNN, 4(CH2), CH3 # SV cGTOs in respective fragments
    assert( np.sum( unit_sizes ) == mol.nao_nr() )

    impurityClusters = []
    if ( casci_energy_formula ): # Do only 1 impurity at the edge
        num_orb_in_imp = np.sum( unit_sizes[ 0 : 1 ] ) # getting total cGTOs in 1st fragment
        impurity_orbitals = np.zeros( [ mol.nao_nr() ], dtype=int ) # creating an array of size total cGTOs
        impurity_orbitals[ 0 : num_orb_in_imp ] = 1
        impurityClusters.append( impurity_orbitals ) # impurityClusters is now [1,1,...,0,...,0] with 1s for first 20 indices
    else: #doesn't go in this block
        jump = 0
        for fragment in range(unit_sizes.size):
            impurity_orbitals = np.zeros( [ mol.nao_nr() ], dtype=int )
            num_orb_in_imp = unit_sizes[fragment]
            if (fragment > 0):
                impurity_orbitals[ jump : jump + num_orb_in_imp ] = -1
            else:
                impurity_orbitals[ jump : jump + num_orb_in_imp ] = 1
            impurityClusters.append( impurity_orbitals )
            jump += num_orb_in_imp

    isTranslationInvariant = False
    method = 'SA-CASPDFT'
    SCmethod = 'NONE'
    theDMET = dmet.dmet( myInts, impurityClusters, isTranslationInvariant, method, SCmethod, doDET=True )
    theDMET.impCAS = (6,10)
    theDMET.doSCF = True
    theDMET.state_average_ = [1/3]*3
    theDMET.fix_spin_val = 6
    theDMET.nroots = 10
    theDMET.nevpt2_roots = np.arange(0,10,1)
    theDMET.nevpt2_nroots = 10
#    theDMET.CASlist = [40,41,42,43,44]
    theDMET.CC_E_TYPE  = 'CASCI'
    the_energy = theDMET.doselfconsistent()
    print ("----Energy:", the_energy)
    print ("Occupation number:",theDMET.OccNum)
        #print and plot orbitals

    X1 = theDMET.ao2loc
    X2 = theDMET.loc2dmet
    nemb = theDMET.numBathOrbs + frag
    for mo in range(0,nemb):
        mo_coeff = reduce(np.dot,(X1,X2[:,:nemb], theDMET.MO))[:,mo].reshape(mol.nao_nr())
        name = 'MO_' + str(mo) + '.cube'
        cubegen.orbital(mol, name, mo_coeff, nx=60, ny=60, nz=60)
    for mo in range(0,nemb):
        mo_coeff = reduce(np.dot,(X1,X2[:,:nemb], theDMET.MOnat))[:,mo].reshape(mol.nao_nr())
        name = 'MO_nat_' + str(mo) + '.cube'
        cubegen.orbital(mol, name, mo_coeff, nx=60, ny=60, nz=60)

#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0308.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64', processor='x86_64')  Threads 8
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.23.5  scipy 1.10.1
Date: Mon Oct  9 15:20:05 2023
PySCF version 2.2.1
PySCF path  /project/lgagliardi/shreyav/apps/pyscf-qcdmet/pyscf
GIT HEAD (branch master) 8eea7e8cab884bddb7a85aa8ba625503d3a8c9cd

[ENV] PYSCF_EXT_PATH /project/lgagliardi/shreyav/apps/pyscf_ext/.pyscf_ext_path:/project/lgagliardi/shreyav/apps/pyscf-qcdmet/pyscf
[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 19
[INPUT] num. electrons = 84
[INPUT] charge = 2
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 Fe     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 O      2.032306000000   0.000000000000   0.000000000000 AA    3.840501741310   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  3 O      0.000000000000   0.000000000000   2.005017000000 AA    0.000000000000   0.000000000000   3.788933005097 Bohr   0.0
[INPUT]  4 O      0.000000000000   2.033621000000   0.000000000000 AA    0.000000000000   3.842986731164   0.000000000000 Bohr   0.0
[INPUT]  5 O     -2.032306000000   0.000000000000   0.000000000000 AA   -3.840501741310   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  6 O      0.000000000000   0.000000000000  -2.005017000000 AA    0.000000000000   0.000000000000  -3.788933005097 Bohr   0.0
[INPUT]  7 O      0.000000000000  -2.033621000000   0.000000000000 AA    0.000000000000  -3.842986731164   0.000000000000 Bohr   0.0
[INPUT]  8 H      2.619309000000   0.772765000000   0.000000000000 AA    4.949776645608   1.460314208650   0.000000000000 Bohr   0.0
[INPUT]  9 H      2.619309000000  -0.772765000000   0.000000000000 AA    4.949776645608  -1.460314208650   0.000000000000 Bohr   0.0
[INPUT] 10 H     -0.781928000000   0.000000000000   2.577493000000 AA   -1.477629769129   0.000000000000   4.870755857984 Bohr   0.0
[INPUT] 11 H      0.781928000000   0.000000000000   2.577493000000 AA    1.477629769129   0.000000000000   4.870755857984 Bohr   0.0
[INPUT] 12 H     -0.769817000000   2.622599000000   0.000000000000 AA   -1.454743296034   4.955993844558   0.000000000000 Bohr   0.0
[INPUT] 13 H      0.769817000000   2.622599000000   0.000000000000 AA    1.454743296034   4.955993844558   0.000000000000 Bohr   0.0
[INPUT] 14 H     -2.619309000000   0.772765000000   0.000000000000 AA   -4.949776645608   1.460314208650   0.000000000000 Bohr   0.0
[INPUT] 15 H     -2.619309000000  -0.772765000000   0.000000000000 AA   -4.949776645608  -1.460314208650   0.000000000000 Bohr   0.0
[INPUT] 16 H     -0.781928000000   0.000000000000  -2.577493000000 AA   -1.477629769129   0.000000000000  -4.870755857984 Bohr   0.0
[INPUT] 17 H      0.781928000000   0.000000000000  -2.577493000000 AA    1.477629769129   0.000000000000  -4.870755857984 Bohr   0.0
[INPUT] 18 H     -0.769817000000  -2.622599000000   0.000000000000 AA   -1.454743296034  -4.955993844558   0.000000000000 Bohr   0.0
[INPUT] 19 H      0.769817000000  -2.622599000000   0.000000000000 AA    1.454743296034  -4.955993844558   0.000000000000 Bohr   0.0

nuclear repulsion = 688.321257201742
number of shells = 75
number of NR pGTOs = 371
number of NR cGTOs = 212
basis = {'O': 'cc-pvdz', 'Fe': 'cc-pvtz', 'H': 'cc-pvdz'}
ecp = {}
CPU time:         0.81


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/9677800/tmp8necp3ct
max_memory 4000 MB (current use 102 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -1716.6216645008
  HOMO = 0.0620251127919096  LUMO = 0.0670904988369774
cycle= 1 E= -1704.39304389246  delta_E= 12.2  |g|= 6.12  |ddm|= 58.6
  HOMO = -1.3763098567284  LUMO = -1.35552049326036
cycle= 2 E= -1653.39945785177  delta_E=   51  |g|= 23.8  |ddm|= 53.2
  HOMO = -1.22553865638498  LUMO = -1.19093139883676
cycle= 3 E= -1691.07474570089  delta_E= -37.7  |g|= 15.1  |ddm|= 26.7
  HOMO = -1.10269213875068  LUMO = -1.07274316675391
cycle= 4 E= -1700.30926150622  delta_E= -9.23  |g|= 11.6  |ddm|= 4.96
  HOMO = -0.978589478930587  LUMO = -0.964034717682497
cycle= 5 E= -1707.51418257648  delta_E= -7.2  |g|= 8.13  |ddm|= 14.7
  HOMO = -0.945676320811778  LUMO = -0.924460058038918
cycle= 6 E= -1709.42094600583  delta_E= -1.91  |g|= 7.03  |ddm|= 4.11

WARN: HOMO -0.824091829614301 == LUMO -0.823360550183502

cycle= 7 E= -1712.07914797484  delta_E= -2.66  |g|= 5.23  |ddm|= 4.51
  HOMO = -0.639888434574759  LUMO = -0.608508956076204
cycle= 8 E= -1717.45292110371  delta_E= -5.37  |g|= 1.28  |ddm|= 3.77
  HOMO = -0.606937767855766  LUMO = -0.285646103746587
cycle= 9 E= -1717.89423570033  delta_E= -0.441  |g|= 0.305  |ddm|= 1.38
  HOMO = -0.680670428878049  LUMO = -0.207344071216517
cycle= 10 E= -1717.9388715762  delta_E= -0.0446  |g|= 0.0932  |ddm|= 1.03
  HOMO = -0.671978737989218  LUMO = -0.205610666294429
cycle= 11 E= -1717.94487704986  delta_E= -0.00601  |g|= 0.0558  |ddm|= 0.184
  HOMO = -0.673667607251749  LUMO = -0.20614772935818
cycle= 12 E= -1717.94765978264  delta_E= -0.00278  |g|= 0.0499  |ddm|= 0.111
  HOMO = -0.67280279813507  LUMO = -0.20607538739517
cycle= 13 E= -1717.94938633599  delta_E= -0.00173  |g|= 0.0517  |ddm|= 0.0669
  HOMO = -0.675907730512502  LUMO = -0.205896609613962
cycle= 14 E= -1717.94390865257  delta_E= 0.00548  |g|= 0.0422  |ddm|= 0.232
  HOMO = -0.687818715619639  LUMO = -0.205810279683568
cycle= 15 E= -1717.9386116877  delta_E= 0.0053  |g|= 0.0342  |ddm|= 0.407
  HOMO = -0.671734316148937  LUMO = -0.205815644777048
cycle= 16 E= -1717.9385171701  delta_E= 9.45e-05  |g|= 0.0148  |ddm|= 0.0638
  HOMO = -0.680310290757746  LUMO = -0.205860748832852
cycle= 17 E= -1717.93825492386  delta_E= 0.000262  |g|= 0.0151  |ddm|= 0.119
  HOMO = -0.675855989472296  LUMO = -0.205874166579696
cycle= 18 E= -1717.93827332543  delta_E= -1.84e-05  |g|= 0.00987  |ddm|= 0.00913
  HOMO = -0.668907600048596  LUMO = -0.205881429875079
cycle= 19 E= -1717.93828793727  delta_E= -1.46e-05  |g|= 0.00181  |ddm|= 0.0146
  HOMO = -0.667125935212395  LUMO = -0.205897149072382
cycle= 20 E= -1717.93828860867  delta_E= -6.71e-07  |g|= 0.000821  |ddm|= 0.0048
  HOMO = -0.667875968964143  LUMO = -0.20588979830037
cycle= 21 E= -1717.93828867984  delta_E= -7.12e-08  |g|= 0.000213  |ddm|= 0.00184
  HOMO = -0.667720165910443  LUMO = -0.205892636640195
cycle= 22 E= -1717.93828868689  delta_E= -7.05e-09  |g|= 1.42e-05  |ddm|= 0.000335
  HOMO = -0.667725101619092  LUMO = -0.205892629155461
cycle= 23 E= -1717.93828868697  delta_E= -8e-11  |g|= 2.49e-06  |ddm|= 5.32e-05
  HOMO = -0.667724574439923  LUMO = -0.205892638234073
Extra cycle  E= -1717.93828868697  delta_E= 1.36e-12  |g|= 1.52e-06  |ddm|= 4.15e-06
converged SCF energy = -1717.93828868697


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 1000
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/9677800/tmp8necp3ct
max_memory 4000 MB (current use 2226 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -1716.6216645008
  HOMO = 0.0620251127909729  LUMO = 0.0670904988370171
cycle= 1 E= -1704.39304389245  delta_E= 12.2  |g|= 6.12  |ddm|= 58.6
  HOMO = -1.3763098567292  LUMO = -1.35552049326134
cycle= 2 E= -1653.39945785174  delta_E=   51  |g|= 23.8  |ddm|= 53.2
  HOMO = -1.2255386563858  LUMO = -1.19093139883777
cycle= 3 E= -1691.07474570088  delta_E= -37.7  |g|= 15.1  |ddm|= 26.7
  HOMO = -1.10269213875146  LUMO = -1.07274316675472
cycle= 4 E= -1700.30926150622  delta_E= -9.23  |g|= 11.6  |ddm|= 4.96
  HOMO = -0.978589478931322  LUMO = -0.964034717682766
cycle= 5 E= -1707.51418257649  delta_E= -7.2  |g|= 8.13  |ddm|= 14.7
  HOMO = -0.945676320812095  LUMO = -0.924460058039379
cycle= 6 E= -1709.42094600582  delta_E= -1.91  |g|= 7.03  |ddm|= 4.11

WARN: HOMO -0.824091829612179 == LUMO -0.823360550182721

cycle= 7 E= -1712.07914797487  delta_E= -2.66  |g|= 5.23  |ddm|= 4.51
  HOMO = -0.639888434581943  LUMO = -0.608508956084776
cycle= 8 E= -1717.4529211037  delta_E= -5.37  |g|= 1.28  |ddm|= 3.77
  HOMO = -0.606937767868496  LUMO = -0.285646103763608
cycle= 9 E= -1717.89423570033  delta_E= -0.441  |g|= 0.305  |ddm|= 1.38
  HOMO = -0.680670428881091  LUMO = -0.207344071216511
cycle= 10 E= -1717.9388715762  delta_E= -0.0446  |g|= 0.0932  |ddm|= 1.03
  HOMO = -0.671978737989761  LUMO = -0.205610666294574
cycle= 11 E= -1717.94487704986  delta_E= -0.00601  |g|= 0.0558  |ddm|= 0.184
  HOMO = -0.673667607252088  LUMO = -0.206147729358244
cycle= 12 E= -1717.94765978264  delta_E= -0.00278  |g|= 0.0499  |ddm|= 0.111
  HOMO = -0.672802798135455  LUMO = -0.206075387395163
cycle= 13 E= -1717.949386336  delta_E= -0.00173  |g|= 0.0517  |ddm|= 0.0669
  HOMO = -0.675907730514329  LUMO = -0.205896609613307
cycle= 14 E= -1717.94390865257  delta_E= 0.00548  |g|= 0.0422  |ddm|= 0.232
  HOMO = -0.687818715624761  LUMO = -0.205810279683178
cycle= 15 E= -1717.93861168771  delta_E= 0.0053  |g|= 0.0342  |ddm|= 0.407
  HOMO = -0.671734316147064  LUMO = -0.205815644776841
cycle= 16 E= -1717.93851717011  delta_E= 9.45e-05  |g|= 0.0148  |ddm|= 0.0638
  HOMO = -0.680310290763046  LUMO = -0.205860748832557
cycle= 17 E= -1717.93825492386  delta_E= 0.000262  |g|= 0.0151  |ddm|= 0.119
  HOMO = -0.675855989477432  LUMO = -0.205874166579552
cycle= 18 E= -1717.93827332543  delta_E= -1.84e-05  |g|= 0.00987  |ddm|= 0.00913
  HOMO = -0.668907600051534  LUMO = -0.205881429875168
cycle= 19 E= -1717.93828793727  delta_E= -1.46e-05  |g|= 0.00181  |ddm|= 0.0146
  HOMO = -0.667125935214318  LUMO = -0.205897149072397
cycle= 20 E= -1717.93828860867  delta_E= -6.71e-07  |g|= 0.000821  |ddm|= 0.0048
  HOMO = -0.667875968963422  LUMO = -0.20588979830036
cycle= 21 E= -1717.93828867984  delta_E= -7.12e-08  |g|= 0.000213  |ddm|= 0.00184
  HOMO = -0.667720165910368  LUMO = -0.205892636640213
cycle= 22 E= -1717.93828868689  delta_E= -7.05e-09  |g|= 1.42e-05  |ddm|= 0.000335
  HOMO = -0.667725101619121  LUMO = -0.205892629155469
cycle= 23 E= -1717.93828868697  delta_E= -8e-11  |g|= 2.49e-06  |ddm|= 5.32e-05
  HOMO = -0.667724574439927  LUMO = -0.205892638234016
Extra cycle  E= -1717.93828868697  delta_E= -9.09e-13  |g|= 1.52e-06  |ddm|= 4.15e-06
converged SCF energy = -1717.93828868697
SV active_orbs:  range(0, 212)
SV active[active_orbs]:  [1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
SV self.Norbs:  212
SV self.Nelec:  84
SV ao2loc for meta_lowdin:  [[ 9.82316728e-01  1.86847698e-01 -1.70173760e-03 ... -4.73874374e-04
  -2.73772309e-03 -1.62005647e-17]
 [-1.86800937e-01  9.84146619e-01  1.63733078e-03 ... -1.24359435e-03
  -8.13066878e-03 -4.74681214e-17]
 [-1.12862082e-03  4.61032725e-03  9.85844412e-01 ...  7.80305538e-03
  -3.39234387e-02 -2.42674540e-16]
 ...
 [ 0.00000000e+00  0.00000000e+00  0.00000000e+00 ...  1.56018657e+00
  -2.63794156e-01 -5.13252220e-16]
 [ 0.00000000e+00  0.00000000e+00  0.00000000e+00 ... -2.63794156e-01
   1.39695130e+00 -2.96399259e-16]
 [ 0.00000000e+00  0.00000000e+00  0.00000000e+00 ... -5.13252220e-16
  -2.96399259e-16  1.14329714e+00]]
SV activeOEI:  [[-3.52786083e+02  2.49986314e+00 -6.80198131e-01 ... -1.37047993e-02
  -2.11001494e-02 -4.47728145e-17]
 [ 2.49986314e+00 -9.76759672e+01  4.47642401e+00 ...  2.73997226e-02
   4.90019022e-02  5.49567675e-17]
 [-6.80198131e-01  4.47642401e+00 -4.68436922e+01 ... -2.42479266e-02
  -6.54409549e-02 -3.85623757e-16]
 ...
 [-1.37047993e-02  2.73997226e-02 -2.42479266e-02 ... -1.44781736e+01
  -3.19540690e-01  4.99843578e-15]
 [-2.11001494e-02  4.90019022e-02 -6.54409549e-02 ... -3.19540690e-01
  -1.48861473e+01  5.01329590e-15]
 [-4.60739997e-17  6.43057077e-17 -4.50318727e-16 ...  4.93123240e-15
   4.88522123e-15 -1.49766729e+01]]
SV twoS=  0
SV: impClust [array([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
       1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
       1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
       1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0])] and its length:  1
SV impurityOrbs:  [1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
SV thearray (stores the total number of impurity orbitals taken in that fragment):  [68]
SV theH1:  [array([[1, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       ...,
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0]]), array([[0, 0, 0, ..., 0, 0, 0],
       [0, 1, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       ...,
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0]]), array([[0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 1, ..., 0, 0, 0],
       ...,
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0]]), array([[0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       ...,
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0]]), array([[0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       ...,
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0]]), array([[0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       ...,
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0]]), array([[0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       ...,
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0]]), array([[0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       ...,
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0]]), array([[0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       ...,
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0]]), array([[0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       ...,
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0]]), array([[0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       ...,
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0]]), array([[0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       ...,
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0]]), array([[0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       ...,
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0]]), array([[0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       ...,
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0]]), array([[0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       ...,
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0]]), array([[0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       ...,
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0]]), array([[0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       ...,
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0]]), array([[0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       ...,
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0]]), array([[0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       ...,
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0]]), array([[0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       ...,
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0]]), array([[0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       ...,
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0]]), array([[0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       ...,
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0]]), array([[0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       ...,
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0]]), array([[0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       ...,
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0]]), array([[0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       ...,
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0]]), array([[0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       ...,
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0]]), array([[0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       ...,
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0]]), array([[0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       ...,
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0]]), array([[0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       ...,
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0]]), array([[0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       ...,
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0]]), array([[0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       ...,
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0]]), array([[0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       ...,
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0]]), array([[0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       ...,
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0]]), array([[0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       ...,
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0]]), array([[0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       ...,
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0]]), array([[0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       ...,
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0]]), array([[0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       ...,
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0]]), array([[0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       ...,
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0]]), array([[0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       ...,
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0]]), array([[0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       ...,
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0]]), array([[0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       ...,
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0]]), array([[0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       ...,
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0]]), array([[0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       ...,
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0]]), array([[0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       ...,
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0]]), array([[0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       ...,
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0]]), array([[0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       ...,
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0]]), array([[0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       ...,
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0]]), array([[0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       ...,
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0]]), array([[0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       ...,
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0]]), array([[0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       ...,
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0]]), array([[0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       ...,
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0]]), array([[0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       ...,
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0]]), array([[0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       ...,
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0]]), array([[0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       ...,
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0]]), array([[0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       ...,
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0]]), array([[0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       ...,
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0]]), array([[0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       ...,
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0]]), array([[0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       ...,
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0]]), array([[0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       ...,
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0]]), array([[0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       ...,
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0]]), array([[0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       ...,
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0]]), array([[0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       ...,
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0]]), array([[0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       ...,
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0]]), array([[0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       ...,
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0]]), array([[0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       ...,
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0]]), array([[0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       ...,
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0]]), array([[0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       ...,
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0]]), array([[0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       ...,
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0]])]
SV self.numPairs:  42.0
***** Entering self-consistent *****
RHF energy = -1717.9382886869685
DMET iteration 1
SV OEI from localintegrals (in local basis):  [[-2.616e+02 -1.316e+00  5.116e-01 ... -4.112e-03 -4.960e-03 -3.820e-16]
 [-1.316e+00 -3.220e+01 -2.476e-01 ...  1.074e-03  1.076e-03 -1.220e-14]
 [ 5.116e-01 -2.476e-01 -4.425e+00 ... -3.268e-04  2.810e-04 -9.931e-15]
 ...
 [-4.112e-03  1.074e-03 -3.268e-04 ...  2.038e+00 -4.047e-01 -7.820e-16]
 [-4.960e-03  1.076e-03  2.810e-04 ... -4.047e-01  1.832e+00 -1.248e-14]
 [-3.842e-16 -1.220e-14 -9.929e-15 ... -7.524e-16 -1.252e-14  1.420e+00]]
SV eigenvecs:  [[ 1.000e+00  5.700e-03  6.334e-19 ... -8.694e-19  3.415e-19 -4.076e-18]
 [ 5.730e-03 -9.999e-01 -6.819e-17 ... -7.494e-18  1.219e-17  2.353e-17]
 [-1.983e-03 -9.005e-03  3.345e-17 ... -2.051e-17 -3.624e-17 -6.337e-17]
 ...
 [ 1.580e-05  3.829e-05 -9.439e-06 ...  1.899e-03 -4.936e-14  6.201e-04]
 [ 1.903e-05  3.975e-05  2.148e-05 ...  6.524e-03 -1.588e-13 -3.881e-03]
 [ 1.553e-18 -3.325e-16 -8.332e-16 ... -1.969e-14 -1.681e-04  2.150e-15]]
SV not here
SV OneRDM in lo basis:  [[ 2.000e+00  2.536e-05 -5.214e-05 ...  3.361e-05  3.744e-05  1.234e-18]
 [ 2.536e-05  2.000e+00  1.621e-04 ... -7.765e-05 -7.167e-05  6.499e-16]
 [-5.214e-05  1.621e-04  1.999e+00 ...  2.553e-04  1.027e-04 -1.518e-15]
 ...
 [ 3.361e-05 -7.765e-05  2.553e-04 ...  1.930e-03 -1.321e-03 -2.647e-15]
 [ 3.744e-05 -7.167e-05  1.027e-04 ... -1.321e-03  1.219e-03 -1.579e-15]
 [ 1.234e-18  6.499e-16 -1.518e-15 ... -2.647e-15 -1.579e-15  1.463e-03]]
SV basis check:  [[ 2.000e+00  1.381e-04  9.731e-04 ... -4.962e-05 -3.363e-06  4.176e-16]
 [ 1.381e-04  2.000e+00  2.833e-03 ... -1.318e-04  1.681e-05  1.666e-15]
 [ 9.731e-04  2.833e-03  2.018e+00 ... -1.367e-03 -7.974e-04 -8.378e-15]
 ...
 [-4.962e-05 -1.318e-04 -1.367e-03 ...  6.419e-03 -3.383e-03 -3.306e-15]
 [-3.363e-06  1.681e-05 -7.974e-04 ... -3.383e-03  3.217e-03 -1.002e-15]
 [ 4.175e-16  1.666e-15 -8.377e-15 ... -3.306e-15 -1.002e-15  1.469e-03]]
SV impurityOrbs to be passed to constructbath:  [1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
SV embeddingOrbs:  [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
SV embeddingOrbs:  [[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1 1 1 1 1 1 1 1
  1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
  1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]]
SV numEmbedOrbs:  144
SV OneDM[isEmbedding]:  [ 2.000e+00  5.592e-04 -2.232e-03 ... -2.647e-15 -1.579e-15  1.463e-03]
SV embedding1RDM:  [[ 2.000e+00  5.592e-04 -2.232e-03 ... -8.260e-07 -1.839e-06 -8.659e-17]
 [ 5.592e-04  1.622e+00 -9.635e-05 ...  2.168e-04 -1.558e-03  4.384e-14]
 [-2.232e-03 -9.635e-05  4.060e-03 ... -1.422e-04 -5.155e-05  8.483e-15]
 ...
 [-8.260e-07  2.168e-04 -1.422e-04 ...  1.930e-03 -1.321e-03 -2.647e-15]
 [-1.839e-06 -1.558e-03 -5.155e-05 ... -1.321e-03  1.219e-03 -1.579e-15]
 [-8.659e-17  4.384e-14  8.483e-15 ... -2.647e-15 -1.579e-15  1.463e-03]]
SV idx:  [114 115 116 113 117 118 112 119 111 120 121 122 123 124 125 126 127 128 129 130 131 132 133 110 134 109 108 135 107 106 136 137 105 138 139 104 103 140 102
 141 142 143 101 100  99  98  97  96  95  94  93  92  91  90  89  88  87  86  85  84  83  82  81  80  79  78  77  76  75  74  73  72  71  70  69  68  67  66
  65  64  63  62  61  60  59  58  57  56  55  54  53  52  51  50  49  48  47  46  45  44  43  42  41  40  39  38  37  36  35  34  33  32  31  30  29  28  27
  26  25  24  23  22  21  20  19  18  17  16  15  14  13  12  11  10   9   8   7   6   5   4   3   2   1   0]
SV tokeep:  42 and numBathOrbs:  68
DMET::constructbath : Throwing out 26 orbitals which are within 1e-13 of 0 or 2.
SV coreOccupations (its length is n cGTOs):  [ 0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00
  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00
  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00
  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00
  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00
  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00
  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00
  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  1.253e-15  6.109e-16
  4.398e-16  3.779e-16  3.735e-16  3.260e-16  3.076e-16  2.839e-16  2.006e-16  1.903e-16  1.636e-16  1.635e-16  1.426e-16  8.369e-17  8.261e-17  7.604e-17
  5.761e-17  5.409e-17  3.782e-17  3.775e-17  2.753e-17  2.634e-17  2.122e-17  1.929e-17  1.776e-17  1.764e-17  1.627e-17  1.286e-17  1.238e-17  1.168e-17
  8.396e-18  7.980e-18  7.212e-18  6.557e-18  5.308e-18  4.484e-18  4.064e-18  3.826e-18  3.566e-18  2.607e-18  2.601e-18  1.931e-18  1.491e-18  1.116e-18
  1.096e-18  4.376e-19  3.697e-19  1.768e-19  5.938e-21 -1.833e-21 -1.681e-19 -3.271e-19 -4.697e-19 -8.536e-19 -1.398e-18 -1.665e-18 -1.795e-18 -1.996e-18
 -2.683e-18 -2.920e-18 -3.285e-18 -3.958e-18 -4.872e-18 -5.504e-18 -5.876e-18 -6.300e-18 -7.859e-18 -8.142e-18 -8.349e-18 -1.017e-17 -1.357e-17 -1.511e-17
 -1.554e-17 -1.726e-17 -2.105e-17 -2.629e-17 -2.754e-17 -3.273e-17 -4.164e-17 -4.365e-17 -5.383e-17 -5.533e-17 -6.009e-17 -7.114e-17 -8.486e-17 -8.963e-17
 -1.107e-16 -1.132e-16 -1.492e-16 -1.613e-16 -2.399e-16 -2.658e-16 -3.450e-16 -3.598e-16 -3.941e-16 -3.994e-16 -5.691e-16 -5.941e-16 -5.992e-16 -7.137e-16
 -1.128e-15 -1.234e-15]
SV eigenvecs:  [[ 1.000e+00  0.000e+00  0.000e+00 ...  0.000e+00  0.000e+00  0.000e+00]
 [ 0.000e+00  1.000e+00  0.000e+00 ...  0.000e+00  0.000e+00  0.000e+00]
 [ 0.000e+00  0.000e+00  1.000e+00 ...  0.000e+00  0.000e+00  0.000e+00]
 ...
 [ 0.000e+00  0.000e+00  0.000e+00 ... -7.430e-03  1.492e-02  8.613e-03]
 [ 0.000e+00  0.000e+00  0.000e+00 ...  3.905e-02 -1.317e-02 -1.427e-02]
 [ 0.000e+00  0.000e+00  0.000e+00 ...  4.952e-04  1.139e-02 -9.603e-03]]
SV core1RDM_dmet:  [ 0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00
  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00
  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00
  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00
  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00
  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00
  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00
  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  0.000e+00  1.253e-15  6.109e-16
  4.398e-16  3.779e-16  3.735e-16  3.260e-16  3.076e-16  2.839e-16  2.006e-16  1.903e-16  1.636e-16  1.635e-16  1.426e-16  8.369e-17  8.261e-17  7.604e-17
  5.761e-17  5.409e-17  3.782e-17  3.775e-17  2.753e-17  2.634e-17  2.122e-17  1.929e-17  1.776e-17  1.764e-17  1.627e-17  1.286e-17  1.238e-17  1.168e-17
  8.396e-18  7.980e-18  7.212e-18  6.557e-18  5.308e-18  4.484e-18  4.064e-18  3.826e-18  3.566e-18  2.607e-18  2.601e-18  1.931e-18  1.491e-18  1.116e-18
  1.096e-18  4.376e-19  3.697e-19  1.768e-19  5.938e-21 -1.833e-21 -1.681e-19 -3.271e-19 -4.697e-19 -8.536e-19 -1.398e-18 -1.665e-18 -1.795e-18 -1.996e-18
 -2.683e-18 -2.920e-18 -3.285e-18 -3.958e-18 -4.872e-18 -5.504e-18 -5.876e-18 -6.300e-18 -7.859e-18 -8.142e-18 -8.349e-18 -1.017e-17 -1.357e-17 -1.511e-17
 -1.554e-17 -1.726e-17 -2.105e-17 -2.629e-17 -2.754e-17 -3.273e-17 -4.164e-17 -4.365e-17 -5.383e-17 -5.533e-17 -6.009e-17 -7.114e-17 -8.486e-17 -8.963e-17
 -1.107e-16 -1.132e-16 -1.492e-16 -1.613e-16 -2.399e-16 -2.658e-16 -3.450e-16 -3.598e-16 -3.941e-16 -3.994e-16 -5.691e-16 -5.941e-16 -5.992e-16 -7.137e-16
 -1.128e-15 -1.234e-15]
SV loc2dmet:  [[ 1.000e+00  0.000e+00  0.000e+00 ...  0.000e+00  0.000e+00  0.000e+00]
 [ 0.000e+00  1.000e+00  0.000e+00 ...  0.000e+00  0.000e+00  0.000e+00]
 [ 0.000e+00  0.000e+00  1.000e+00 ...  0.000e+00  0.000e+00  0.000e+00]
 ...
 [ 0.000e+00  0.000e+00  0.000e+00 ... -7.430e-03  1.492e-02  8.613e-03]
 [ 0.000e+00  0.000e+00  0.000e+00 ...  3.905e-02 -1.317e-02 -1.427e-02]
 [ 0.000e+00  0.000e+00  0.000e+00 ...  4.952e-04  1.139e-02 -9.603e-03]]
SV core1RDM_loc 1:  [[0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 ...
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]] and Norb_in_imp:  110
SV dmetOrbs:  [array([[ 1.000e+00,  0.000e+00,  0.000e+00, ...,  0.000e+00,  0.000e+00,  0.000e+00],
       [ 0.000e+00,  1.000e+00,  0.000e+00, ...,  0.000e+00,  0.000e+00,  0.000e+00],
       [ 0.000e+00,  0.000e+00,  1.000e+00, ...,  0.000e+00,  0.000e+00,  0.000e+00],
       ...,
       [ 0.000e+00,  0.000e+00,  0.000e+00, ..., -2.242e-04,  1.203e-04, -8.815e-05],
       [ 0.000e+00,  0.000e+00,  0.000e+00, ...,  1.547e-04, -3.812e-05,  8.951e-05],
       [ 0.000e+00,  0.000e+00,  0.000e+00, ..., -3.879e-12, -6.151e-13, -4.816e-12]])]
SV FOCKdmet:  [[-3.528e+02  2.500e+00 -6.802e-01 ...  2.605e-11 -4.802e-04 -1.946e-09]
 [ 2.500e+00 -9.768e+01  4.476e+00 ... -2.996e-11 -3.297e-04 -1.322e-09]
 [-6.802e-01  4.476e+00 -4.684e+01 ...  4.292e-11  1.624e-03  6.542e-09]
 ...
 [ 2.605e-11 -2.996e-11  4.292e-11 ... -4.821e+01  2.493e-10  3.023e-09]
 [-4.802e-04 -3.297e-04  1.624e-03 ...  2.493e-10 -4.825e+01 -5.264e-08]
 [-1.946e-09 -1.322e-09  6.542e-09 ...  3.023e-09 -5.264e-08 -4.824e+01]]
DMET::exact : Performing a ( 110 orb, 84 el ) DMET active space calculation.
SV localintegrals numAct=  110
SV ao2dmet, ao2mdet_act:  [[ 0.982  0.187 -0.002 ...  0.005  0.001 -0.004]
 [-0.187  0.984  0.002 ...  0.015  0.004 -0.013]
 [-0.001  0.005  0.986 ...  0.088  0.027 -0.072]
 ...
 [ 0.     0.     0.    ... -0.009  0.043  0.009]
 [ 0.     0.     0.    ...  0.056 -0.03  -0.034]
 [ 0.     0.     0.    ...  0.008  0.011 -0.008]] [[ 9.823e-01  1.868e-01 -1.702e-03 ... -1.393e-12  4.116e-05  1.666e-10]
 [-1.868e-01  9.841e-01  1.637e-03 ... -3.835e-12  1.117e-04  4.521e-10]
 [-1.129e-03  4.610e-03  9.858e-01 ... -2.372e-11  7.183e-04  2.907e-09]
 ...
 [ 0.000e+00  0.000e+00  0.000e+00 ... -6.538e-05  1.816e-04 -8.066e-05]
 [ 0.000e+00  0.000e+00  0.000e+00 ...  1.514e-04 -7.353e-05  1.176e-04]
 [ 0.000e+00  0.000e+00  0.000e+00 ... -1.303e-11 -9.180e-13 -1.403e-11]]
CAS Selection: ( 6 , 10 )
SV no FakeCISolver
Dimension: 110
Impurity active space:  6 electrons in  10  orbitals
Impurity CASSCF energy:  -2406.658402803612
********  The solver is converged.  ********
SV new 1RDM:  [[ 2.000e+00  1.183e-04  1.133e-03 ... -5.335e-05 -1.992e-05  6.375e-10]
 [ 1.183e-04  2.000e+00  3.235e-03 ... -1.714e-04 -7.251e-05  4.861e-11]
 [ 1.133e-03  3.235e-03  2.024e+00 ... -1.123e-03 -4.895e-04  8.429e-08]
 ...
 [-5.335e-05 -1.714e-04 -1.123e-03 ...  6.451e-03 -3.453e-03  1.498e-08]
 [-1.992e-05 -7.251e-05 -4.895e-04 ... -3.453e-03  3.273e-03 -7.726e-09]
 [ 6.375e-10  4.861e-11  8.429e-08 ...  1.498e-08 -7.726e-09  1.487e-03]]
       State 0 (0.333): E(Solver) = -2406.66695323  E(Imp) = -2406.66695323  <S^2> = 6.000000
***** Starting to calculate MCPDFT Energy *****
You are doing a SA-MCPDFT calculation with  tPBE on-top functional!
Building tPBE functional
SV hyb:  [0, 0]
**** Starting on-top energy calculation ****
MCPDFT spin:  0
tot grids = 225904
**** This is the breakdown ****
Vnn:  688.3212572017422
Te_Vne:  -3722.498539732972
E_j:  1423.9619866121736
E_x:  0
E_ot:  -110.79566789879343
E_tot:  -1721.0109638178494
The DMET-PDFT energy is:  -1721.0109638178494
The on-top energy is:  -110.79566789879343
The MC-PDFT energy of State  0  is:  -1721.0109638178494
SV new 1RDM:  [[ 2.000e+00  1.183e-04  1.133e-03 ... -5.338e-05 -1.995e-05  6.118e-10]
 [ 1.183e-04  2.000e+00  3.235e-03 ... -1.715e-04 -7.260e-05 -2.769e-11]
 [ 1.133e-03  3.235e-03  2.024e+00 ... -1.123e-03 -4.901e-04  8.393e-08]
 ...
 [-5.338e-05 -1.715e-04 -1.123e-03 ...  6.448e-03 -3.449e-03  1.465e-08]
 [-1.995e-05 -7.260e-05 -4.901e-04 ... -3.449e-03  3.264e-03 -8.183e-09]
 [ 6.118e-10 -2.769e-11  8.393e-08 ...  1.465e-08 -8.183e-09  1.487e-03]]
       State 1 (0.333): E(Solver) = -2406.65891827  E(Imp) = -2406.65891827  <S^2> = 6.000000
***** Starting to calculate MCPDFT Energy *****
You are doing a SA-MCPDFT calculation with  tPBE on-top functional!
Building tPBE functional
SV hyb:  [0, 0]
**** Starting on-top energy calculation ****
MCPDFT spin:  0
tot grids = 225904
**** This is the breakdown ****
Vnn:  688.3212572017422
Te_Vne:  -3722.6014098014816
E_j:  1424.0830657850265
E_x:  0
E_ot:  -110.80464731168321
E_tot:  -1721.001734126396
The DMET-PDFT energy is:  -1721.001734126396
The on-top energy is:  -110.80464731168321
The MC-PDFT energy of State  1  is:  -1721.001734126396
SV new 1RDM:  [[ 2.000e+00  1.183e-04  1.133e-03 ... -5.337e-05 -1.995e-05  8.144e-10]
 [ 1.183e-04  2.000e+00  3.235e-03 ... -1.715e-04 -7.260e-05  6.843e-10]
 [ 1.133e-03  3.235e-03  2.024e+00 ... -1.123e-03 -4.900e-04  8.453e-08]
 ...
 [-5.337e-05 -1.715e-04 -1.123e-03 ...  6.448e-03 -3.449e-03  1.557e-08]
 [-1.995e-05 -7.260e-05 -4.900e-04 ... -3.449e-03  3.264e-03 -8.099e-09]
 [ 8.144e-10  6.843e-10  8.453e-08 ...  1.557e-08 -8.099e-09  1.499e-03]]
       State 2 (0.333): E(Solver) = -2406.64933690  E(Imp) = -2406.64933690  <S^2> = 6.000000
***** Starting to calculate MCPDFT Energy *****
You are doing a SA-MCPDFT calculation with  tPBE on-top functional!
Building tPBE functional
SV hyb:  [0, 0]
**** Starting on-top energy calculation ****
MCPDFT spin:  0
tot grids = 225904
**** This is the breakdown ****
Vnn:  688.3212572017422
Te_Vne:  -3722.6585363445115
E_j:  1424.1593294065983
E_x:  0
E_ot:  -110.81356109223033
E_tot:  -1720.9915108284013
The DMET-PDFT energy is:  -1720.9915108284013
The on-top energy is:  -110.81356109223033
The MC-PDFT energy of State  2  is:  -1720.9915108284013
E_CASSCF before NEVPT2:  [-2406.667 -2406.659 -2406.649]
fix_spin_val:  6
=====================================
== State 0: 0.4132|1110,10101> + 0.4077|10101,1110> + 0.4065|111,11100> + -0.4058|1101,10110>
   Occupancy: [1.995e+00 9.992e-01 9.987e-01 9.987e-01 9.986e-01 3.981e-03 1.112e-03 1.500e-03 1.497e-03 1.368e-03]
== State 1: 0.4228|11001,111> + 0.4166|10011,1101> + 0.4136|111,11001> + 0.4087|1101,10011>
   Occupancy: [1.998e+00 1.002e+00 9.980e-01 9.996e-01 9.997e-01 1.029e-03 4.541e-04 4.705e-04 4.245e-04 3.508e-04]
== State 2: -0.4334|11010,111> + 0.4091|1011,10110> + -0.4069|1110,10011> + -0.4013|111,11010>
   Occupancy: [1.996e+00 9.984e-01 9.992e-01 1.002e+00 1.002e+00 1.071e-03 3.900e-04 4.198e-04 4.687e-04 4.874e-04]
== State 3: -0.5472|111,11100> + 0.5416|11100,111> + 0.2430|1101,10110> + -0.2216|10110,1101>
   Occupancy: [1.811 1.098 0.903 1.032 1.034 0.082 0.015 0.014 0.005 0.004]
== State 4: -0.6990|111,1101> + 0.6955|1101,111> + -0.0700|11100,10110> + 0.0681|10110,11100>
   Occupancy: [1.968e+00 1.983e+00 1.003e+00 1.005e+00 2.846e-02 3.536e-05 1.665e-03 2.144e-03 4.691e-03 4.784e-03]
== State 5: 0.6121|111,10011> + -0.6111|10011,111> + -0.2520|1110,10101> + 0.2425|10101,1110>
   Occupancy: [1.762e+00 1.753e+00 1.045e+00 1.227e+00 1.961e-01 5.716e-04 2.766e-03 5.370e-03 3.931e-03 5.170e-03]
== State 6: 0.6090|10110,111> + -0.5878|111,10110> + -0.3332|111,11001> + 0.3226|11001,111>
   Occupancy: [1.269e+00 1.717e+00 1.718e+00 1.019e+00 2.647e-01 2.840e-03 3.526e-03 3.645e-03 1.881e-03 5.411e-04]
== State 7: -0.3936|10101,10110> + 0.3885|10110,10101> + -0.3699|10110,1101> + 0.3571|1101,10110>
   Occupancy: [9.994e-01 1.798e+00 1.811e+00 1.091e+00 2.796e-01 7.723e-03 7.044e-04 6.164e-03 3.584e-03 3.502e-03]
== State 8: -0.5779|10011,1101> + 0.5711|1101,10011> + -0.3460|11001,111> + 0.3451|111,11001>
   Occupancy: [1.965e+00 1.247e+00 7.375e-01 1.016e+00 1.017e+00 6.854e-03 1.882e-03 3.037e-03 3.344e-03 3.539e-03]
== State 9: 0.6272|11010,111> + -0.6170|111,11010> + 0.3010|10110,11100> + -0.2750|11100,10110>
   Occupancy: [1.783 0.871 0.989 1.198 1.142 0.006 0.003 0.004 0.002 0.002]
=====================================
E_CASSCF:  (array([-2406.667, -2406.659, -2406.649]), array([[ 5.996e+00, -2.407e+03, -2.407e+03],
       [ 5.980e+00, -2.407e+03, -2.407e+03],
       [ 5.982e+00, -2.407e+03, -2.409e+03],
       [ 2.345e+00, -2.404e+03, -2.404e+03],
       [ 1.998e+00, -2.403e+03, -2.404e+03],
       [ 2.000e+00, -2.403e+03, -2.404e+03],
       [ 1.998e+00, -2.403e+03, -2.404e+03],
       [ 2.003e+00, -2.403e+03, -2.404e+03],
       [ 1.998e+00, -2.403e+03, -2.404e+03],
       [ 1.997e+00, -2.403e+03, -2.404e+03]]))
e_mol:  -2406.658402803612
SV IMP_energy:  -2406.658402803612
SV E_casscf:  (array([-2406.667, -2406.659, -2406.649]), array([[ 5.996e+00, -2.407e+03, -2.407e+03],
       [ 5.980e+00, -2.407e+03, -2.407e+03],
       [ 5.982e+00, -2.407e+03, -2.409e+03],
       [ 2.345e+00, -2.404e+03, -2.404e+03],
       [ 1.998e+00, -2.403e+03, -2.404e+03],
       [ 2.000e+00, -2.403e+03, -2.404e+03],
       [ 1.998e+00, -2.403e+03, -2.404e+03],
       [ 2.003e+00, -2.403e+03, -2.404e+03],
       [ 1.998e+00, -2.403e+03, -2.404e+03],
       [ 1.997e+00, -2.403e+03, -2.404e+03]]))
SV Nelectrons:  24.511787677283838
SV Nefrag:  [24.511787677283838]
Fragment energies: [-2406.658402803612]
Fragment electrons: [24.511787677283838]
DEBUG Energy before adding up envi contribution: [-2406.667 -2406.659 -2406.649]
-----NOTE: CASCI or Single embedding is used-----
SV totalOEI:  [[-3.528e+02  2.500e+00 -6.802e-01 ... -1.370e-02 -2.110e-02 -4.477e-17]
 [ 2.500e+00 -9.768e+01  4.476e+00 ...  2.740e-02  4.900e-02  5.496e-17]
 [-6.802e-01  4.476e+00 -4.684e+01 ... -2.425e-02 -6.544e-02 -3.856e-16]
 ...
 [-1.370e-02  2.740e-02 -2.425e-02 ... -1.448e+01 -3.195e-01  4.998e-15]
 [-2.110e-02  4.900e-02 -6.544e-02 ... -3.195e-01 -1.489e+01  5.013e-15]
 [-4.607e-17  6.431e-17 -4.503e-16 ...  4.931e-15  4.885e-15 -1.498e+01]]
SV FOCKdmet:  [[-3.528e+02  2.500e+00 -6.802e-01 ... -1.370e-02 -2.110e-02 -4.477e-17]
 [ 2.500e+00 -9.768e+01  4.476e+00 ...  2.740e-02  4.900e-02  5.496e-17]
 [-6.802e-01  4.476e+00 -4.684e+01 ... -2.425e-02 -6.544e-02 -3.856e-16]
 ...
 [-1.370e-02  2.740e-02 -2.425e-02 ... -1.448e+01 -3.195e-01  4.998e-15]
 [-2.110e-02  4.900e-02 -6.544e-02 ... -3.195e-01 -1.489e+01  5.013e-15]
 [-4.607e-17  6.431e-17 -4.503e-16 ...  4.931e-15  4.885e-15 -1.498e+01]]
SV self.energy:  [-2406.667 -2406.659 -2406.649]
      State 0 weight 0.33333: E = -1718.34569603
      State 1 weight 0.33333: E = -1718.33766107
      State 2 weight 0.33333: E = -1718.32807970
NEVPT2 energies for the selected states:
      State 0: E(CASCI) = -2406.65819471   E(NEVPT2) = -1718.87494125   <S^2> = 5.996213
      State 1: E(CASCI) = -2406.62778104   E(NEVPT2) = -1718.89762067   <S^2> = 5.979665
      State 2: E(CASCI) = -2406.61804166   E(NEVPT2) = -1721.11139491   <S^2> = 5.981711
      State 3: E(CASCI) = -2403.82520045   E(NEVPT2) = -1716.12253999   <S^2> = 2.345032
      State 4: E(CASCI) = -2403.39097746   E(NEVPT2) = -1715.63628490   <S^2> = 1.997879
      State 5: E(CASCI) = -2403.38686166   E(NEVPT2) = -1715.62862259   <S^2> = 1.999733
      State 6: E(CASCI) = -2403.38520081   E(NEVPT2) = -1715.63348341   <S^2> = 1.997568
      State 7: E(CASCI) = -2403.37136233   E(NEVPT2) = -1715.61061075   <S^2> = 2.003429
      State 8: E(CASCI) = -2403.34469156   E(NEVPT2) = -1715.58417604   <S^2> = 1.998107
      State 9: E(CASCI) = -2403.33473790   E(NEVPT2) = -1715.57286283   <S^2> = 1.997088
Energy decomposition for debug: [-2406.667 -2406.659 -2406.649] [0. 0. 0.] [-2406.667 -2406.659 -2406.649]
Nuclear potential: 688.3212572017422
   Energy = [-1718.346 -1718.338 -1718.328]
SV umatflat:  [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
SV OEI from localintegrals (in local basis):  [[-2.616e+02 -1.316e+00  5.116e-01 ... -4.112e-03 -4.960e-03 -3.820e-16]
 [-1.316e+00 -3.220e+01 -2.476e-01 ...  1.074e-03  1.076e-03 -1.220e-14]
 [ 5.116e-01 -2.476e-01 -4.425e+00 ... -3.268e-04  2.810e-04 -9.931e-15]
 ...
 [-4.112e-03  1.074e-03 -3.268e-04 ...  2.038e+00 -4.047e-01 -7.820e-16]
 [-4.960e-03  1.076e-03  2.810e-04 ... -4.047e-01  1.832e+00 -1.248e-14]
 [-3.842e-16 -1.220e-14 -9.929e-15 ... -7.524e-16 -1.252e-14  1.420e+00]]
SV eigenvecs:  [[ 1.000e+00  5.700e-03  6.334e-19 ... -8.694e-19  3.415e-19 -4.076e-18]
 [ 5.730e-03 -9.999e-01 -6.819e-17 ... -7.494e-18  1.219e-17  2.353e-17]
 [-1.983e-03 -9.005e-03  3.345e-17 ... -2.051e-17 -3.624e-17 -6.337e-17]
 ...
 [ 1.580e-05  3.829e-05 -9.439e-06 ...  1.899e-03 -4.936e-14  6.201e-04]
 [ 1.903e-05  3.975e-05  2.148e-05 ...  6.524e-03 -1.588e-13 -3.881e-03]
 [ 1.553e-18 -3.325e-16 -8.332e-16 ... -1.969e-14 -1.681e-04  2.150e-15]]
SV not here
   Cost function after convergence = 2.890237080301329
The u-matrix =
[[0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 ...
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]]
The ED 1-RDM of the impurities ( + baths ) =
[[ 2.000e+00  2.575e-05 -5.881e-05 ... -7.600e-12  7.298e-08  4.135e-12]
 [ 2.575e-05  2.000e+00  1.984e-04 ...  2.129e-11 -2.494e-07 -1.794e-11]
 [-5.881e-05  1.984e-04  2.000e+00 ... -2.368e-11  2.650e-06  7.884e-11]
 ...
 [-7.600e-12  2.129e-11 -2.368e-11 ...  2.000e+00 -5.645e-12  2.331e-13]
 [ 7.298e-08 -2.494e-07  2.650e-06 ... -5.645e-12  2.000e+00  2.591e-13]
 [ 4.135e-12 -1.794e-11  7.884e-11 ...  2.331e-13  2.591e-13  2.000e+00]]
   2-norm of difference old and new u-mat = 0.0
   2-norm of difference old and new 1-RDM = 6.607030896951769
******************************************************
Time cf func = 11.795354127883911
Time cf grad = 0.0
Time dmet ed = 393.3608672618866
Time dmet cf = 11.796117067337036
----Energy: (array([-1718.346, -1718.338, -1718.328]), -1718.874941246058)
Occupation number: [2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.
 2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    1.328 1.328 1.328 0.997 0.997 0.005 0.005 0.005 0.003 0.003 0.    0.    0.
 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
 0.    0.    0.    0.    0.    0.   ]
